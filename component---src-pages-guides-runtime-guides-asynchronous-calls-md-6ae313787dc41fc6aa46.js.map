{"version":3,"file":"component---src-pages-guides-runtime-guides-asynchronous-calls-md-6ae313787dc41fc6aa46.js","mappings":"kTAMaA,EAAe,CAAC,EACvBC,EAAc,CAClBD,gBAEIE,EAAYC,EAAAA,EACH,SAASC,EAAUC,GAG/B,IAHgC,WACjCC,GAEDD,EADIE,GAAKC,EAAAA,EAAAA,GAAAH,EAAAI,GAER,OAAOC,EAAAA,EAAAA,KAACR,GAASS,EAAAA,EAAAA,GAAA,GAAKV,EAAiBM,EAAK,CAAED,WAAYA,EAAYM,QAAQ,eAG5EF,EAAAA,EAAAA,KAAA,MACE,GAAM,sBACJ,uBACJA,EAAAA,EAAAA,KAAA,SAAI,+NACJA,EAAAA,EAAAA,KAAA,SAAI,uOACJA,EAAAA,EAAAA,KAAA,MACE,GAAM,0DACJ,4DACJA,EAAAA,EAAAA,KAAA,SAAI,0CAAyCA,EAAAA,EAAAA,KAAA,cAAYG,WAAW,KAAK,UAAuB,iEAChGH,EAAAA,EAAAA,KAAA,YAAKA,EAAAA,EAAAA,KAAA,QAAMG,WAAW,OAAe,sZAiBrCH,EAAAA,EAAAA,KAAA,SAAI,oBAAmBA,EAAAA,EAAAA,KAAA,cAAYG,WAAW,KAAK,MAAmB,oNACtEH,EAAAA,EAAAA,KAAA,YAAKA,EAAAA,EAAAA,KAAA,QAAMG,WAAW,OAAe,0DAErCH,EAAAA,EAAAA,KAAA,SAAI,8CAA6CA,EAAAA,EAAAA,KAAA,cAAYG,WAAW,KAAK,UAAuB,iMACpGH,EAAAA,EAAAA,KAAA,YAAKA,EAAAA,EAAAA,KAAA,QAAMG,WAAW,OAAe,ugBAiBrCH,EAAAA,EAAAA,KAAA,SAAI,sCACJA,EAAAA,EAAAA,KAAA,YAAKA,EAAAA,EAAAA,KAAA,QAAMG,WAAW,OAAe,0DAErCH,EAAAA,EAAAA,KAAA,SAAI,mEAAkEA,EAAAA,EAAAA,KAAA,cAAYG,WAAW,KAAK,UAAuB,uDACzHH,EAAAA,EAAAA,KAAA,SAAI,mCAAkCA,EAAAA,EAAAA,KAAA,cAAYG,WAAW,KAAK,SAAsB,sFACxFH,EAAAA,EAAAA,KAAA,YAAKA,EAAAA,EAAAA,KAAA,QAAMG,WAAW,OAAe,8HAKrCH,EAAAA,EAAAA,KAAA,MACE,GAAM,qCACJ,uCACJA,EAAAA,EAAAA,KAAA,SAAI,yLACJA,EAAAA,EAAAA,KAAA,SAAI,gCAA+BA,EAAAA,EAAAA,KAAA,cAAYG,WAAW,KAAK,aAA0B,wBACzFH,EAAAA,EAAAA,KAAA,YAAKA,EAAAA,EAAAA,KAAA,QAAMG,WAAW,OAAe,yKAMrCH,EAAAA,EAAAA,KAAA,SAAI,yBAAwBA,EAAAA,EAAAA,KAAA,cAAYG,WAAW,KAAK,qBAAkC,8CAA6CH,EAAAA,EAAAA,KAAA,cAAYG,WAAW,KAAK,aAA0B,4JAC7LH,EAAAA,EAAAA,KAAA,YAAKA,EAAAA,EAAAA,KAAA,QAAMG,WAAW,OAAe,gJAErCH,EAAAA,EAAAA,KAAA,SAAI,mFAAkFA,EAAAA,EAAAA,KAAA,cAAYG,WAAW,KAAK,MAAmB,yCACrIH,EAAAA,EAAAA,KAAA,YAAKA,EAAAA,EAAAA,KAAA,QAAMG,WAAW,OAAe,+CAErCH,EAAAA,EAAAA,KAAA,SAAI,wOACJA,EAAAA,EAAAA,KAAA,MACE,GAAM,cACJ,eACJA,EAAAA,EAAAA,KAAA,SAAI,gBAAeA,EAAAA,EAAAA,KAAA,KAAGG,WAAW,IAC7B,KAAQ,mCACN,sBAA0B,MAChCH,EAAAA,EAAAA,KAAA,SAAI,cAAaA,EAAAA,EAAAA,KAAA,KAAGG,WAAW,IAC3B,KAAQ,eACN,gBAAoB,KAG9B,CAEAT,EAAWU,gBAAiB,C","sources":["webpack://adobe-developer-app-builder/./src/pages/guides/runtime_guides/asynchronous_calls.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/app-builder/app-builder/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"asynchronous-calls\"\n    }}>{`Asynchronous Calls`}</h1>\n    <p>{`The system executes web actions or REST APIs as synchronous (blocking) calls and gives them 60 seconds to complete their work. Actions that need more time can use asynchronous (async) calls, and use up to 180 minutes. `}</p>\n    <p>{`Since web actions and APIs are always executed synchronously, you need to separate work that needs more time (the async call) from work that can be done in under a minute using synchronous calls. There are two ways to do this:`}</p>\n    <h2 {...{\n      \"id\": \"option-1-web-action-that-calls-the-actual-action-async\"\n    }}>{`Option 1: web action that calls the actual action async`}</h2>\n    <p>{`First, we create an action. This one, `}<inlineCode parentName=\"p\">{`worker`}</inlineCode>{`, uses a setTimeout function to simulate long-running code. `}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`// worker.js\nfunction main(args) {\n    return new Promise(function(resolve, reject) {\n        setTimeout(function() {\n            var result = {\n                statusCode: 200,\n                body: { \n                    payload: 'Hello from the long running job!'\n                }\n            };\n            resolve(result);\n        }, 100000);\n    });   \n}\n\nexports.main = main;\n`}</code></pre>\n    <p>{`Next we set the `}<inlineCode parentName=\"p\">{`-t`}</inlineCode>{` flag to change the default timeout. If we know that an action needs about 100,000 milliseconds to complete, we can set it to 120,000 milliseconds (2 minutes) to be sure it completes its work before timeout.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`aio rt:action:create my-worker worker.js -t 120000\n`}</code></pre>\n    <p>{`Then we build a web action that calls the `}<inlineCode parentName=\"p\">{`worker`}</inlineCode>{` action we created above. We can simplify this step by using the OpenWhisk Node module. Since it's part of I/O Runtime Node.js environment, we don't need to pack the module with our code. `}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`//web-action.js\nlet openwhisk = require(\"openwhisk\");\n\n // This returns the activation ID of the action that it called\nfunction main(args) {\n    let ow = openwhisk();\n    return ow.actions.invoke({\n                    name: 'worker', // the name of the action to invoke\n                    blocking: false, // this is the flag that instructs to execute the worker asynchronous\n                    result: false,\n                    params: args\n                    }); \n\n}\n\nexports.main = main;\n`}</code></pre>\n    <p>{`Now we can create the web action:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`aio rt:action:create test web-action.js --web true\n`}</code></pre>\n    <p>{`Invoking this web action will deliver the ActivationId for the `}<inlineCode parentName=\"p\">{`worker`}</inlineCode>{` action, which can be used to retrieve the result.`}</p>\n    <p>{`In this sample invocation, the `}<inlineCode parentName=\"p\">{`.json`}</inlineCode>{` extension appended to the URI instructs the system to return the result as JSON:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`curl https://adobeioruntime.net/api/v1/web/YOUR-NAMESPACE-HERE/default/test.json\n{\n  \"activationId\": \"0123456789\"\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"option-2-using-triggers-and-rules\"\n    }}>{`Option 2: using triggers and rules`}</h2>\n    <p>{`Another way to set up an asynchronous call is to create a trigger and a rule to call the action. This will work only for calls using a POST method; if you need a GET, use Option 1.`}</p>\n    <p>{`Here is the code, using the `}<inlineCode parentName=\"p\">{`my-worker`}</inlineCode>{` action from above:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`// First, you create a trigger\naio rt:trigger:create my-worker-trigger\n\n//Then, you create the rule\naio rt:rule:create async-rule my-worker-trigger my-worker\n`}</code></pre>\n    <p>{`Now when the trigger `}<inlineCode parentName=\"p\">{`my-worker-trigger`}</inlineCode>{` is executed, it will in turn execute the `}<inlineCode parentName=\"p\">{`my-worker`}</inlineCode>{` action. Note the authentication header: it must match the authentication as used by the namespace where the actions, triggers, and rules were created.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`curl https://adobeioruntime.net/api/v1/namespaces/_/triggers/my-worker-trigger -X POST -H \"Authorization: Basic NAMESPACE AUTHORIZATION\"\n`}</code></pre>\n    <p>{`To find the URI and the authorization for a trigger or secured web action, add `}<inlineCode parentName=\"p\">{`-v`}</inlineCode>{` (verbose) to the command to get it:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`aio rt:trigger:get my-worker-trigger -v\n`}</code></pre>\n    <p>{`Retrieval of the action activationId (and not the trigger activationId) is trickier than in Option 1. Use the trigger activationId to retrieve the logs, which will contain the action activationId you can use to read the result.`}</p>\n    <h2 {...{\n      \"id\": \"next-steps\"\n    }}>{`Next steps`}</h2>\n    <p>{`Learn about `}<a parentName=\"p\" {...{\n        \"href\": \"reference_docs/triggersrules.md\"\n      }}>{`Triggers and Rules`}</a>{`.`}</p>\n    <p>{`Return to `}<a parentName=\"p\" {...{\n        \"href\": \"../index.md\"\n      }}>{`Guides Index`}</a>{`.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","_ref","components","props","_objectWithoutProperties","_excluded","mdx","_extends","mdxType","parentName","isMDXComponent"],"sourceRoot":""}