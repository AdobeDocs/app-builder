"use strict";(self.webpackChunkadobe_developer_app_builder=self.webpackChunkadobe_developer_app_builder||[]).push([[8152],{38492:function(e,n,i){i.r(n),i.d(n,{_frontmatter:function(){return l},default:function(){return s}});var o=i(58168),t=i(80045),a=(i(88763),i(15680)),r=i(83407);const d=["components"],l={},m={_frontmatter:l},p=r.A;function s(e){let{components:n}=e,i=(0,t.A)(e,d);return(0,a.mdx)(p,(0,o.A)({},m,i,{components:n,mdxType:"MDXLayout"}),(0,a.mdx)("h1",{id:"webpack-configuration"},"Webpack Configuration"),(0,a.mdx)("h2",{id:"overview"},"Overview"),(0,a.mdx)("p",null,"App Builder bundles Runtime action code using Webpack. Users can specify Webpack configurations for individual actions, sets of actions, or entire projects. See ",(0,a.mdx)("a",{parentName:"p",href:"https://webpack.js.org/configuration"},"the Webpack site")," for configuration options."),(0,a.mdx)("h2",{id:"configuration-file"},"Configuration file"),(0,a.mdx)("p",null,"When Runtime action code is bundled during ",(0,a.mdx)("inlineCode",{parentName:"p"},"aio app build|run|deploy")," the action directory is searched for a webpack config file named ",(0,a.mdx)("inlineCode",{parentName:"p"},"*webpack-config.js"),". The search is done first in the directory of the action being built, then the parent directory, up to the project root."),(0,a.mdx)("ul",null,(0,a.mdx)("li",{parentName:"ul"},(0,a.mdx)("p",{parentName:"li"},"To specify a Webpack configuration for a single action, place the ",(0,a.mdx)("inlineCode",{parentName:"p"},"*webpack-config.js")," file in the action folder.")),(0,a.mdx)("li",{parentName:"ul"},(0,a.mdx)("p",{parentName:"li"},"To specify a Webpack configuration for a set of actions, place the ",(0,a.mdx)("inlineCode",{parentName:"p"},"*webpack-config.js")," file in the parent directory of your action\nfolders.")),(0,a.mdx)("li",{parentName:"ul"},(0,a.mdx)("p",{parentName:"li"},"To specify a Webpack configuration for an entire project, place the ",(0,a.mdx)("inlineCode",{parentName:"p"},"*webpack-config.js")," file in the root directory of your project."))),(0,a.mdx)("h3",{id:"es-module-syntax"},"ES module syntax"),(0,a.mdx)("p",null,"App Builder does not currently support ES Module syntax. This file must be written in CommonJS, or failures will occur at build time. "),(0,a.mdx)("h2",{id:"configuration-types"},"Configuration types"),(0,a.mdx)("p",null,"App Builder supports exporting the following configuration types in ",(0,a.mdx)("inlineCode",{parentName:"p"},"*webpack-config.js"),":"),(0,a.mdx)("h3",{id:"objects"},"Objects"),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = { \n  mode: 'development' \n}\n")),(0,a.mdx)("h3",{id:"functions-that-return-objects"},"Functions that return objects"),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = (env) => ({\n  mode: 'development'\n})\n")),(0,a.mdx)("h3",{id:"functions-that-return-arrays-of-objects"},"Functions that return arrays of objects"),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = (env) => ([\n  {\n    mode: 'development' \n  },\n  {\n    mode: 'production'\n  }\n])\n")),(0,a.mdx)("h3",{id:"asynchronous-functions-that-return-objects"},"Asynchronous functions that return objects"),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = async (env) => ({\n  mode: 'development'\n})\n")),(0,a.mdx)("h3",{id:"asynchronous-functions-that-return-arrays-of-objects"},"Asynchronous functions that return arrays of objects"),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = async (env) => ([\n  {\n    mode: 'development' \n  },\n  {\n    mode: 'production'\n  }\n])\n")),(0,a.mdx)("h3",{id:"arrays-of-objects"},"Arrays of objects"),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = [\n  {\n    mode: 'development'\n  },\n  {\n    mode: 'production'\n  }\n]\n")),(0,a.mdx)("h3",{id:"arrays-of-functions-that-return-objects"},"Arrays of functions that return objects"),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = [\n  (env) => ({\n    mode: 'development'\n  }),\n  (env) => ({\n    mode: 'production'\n  })\n]\n")),(0,a.mdx)("h3",{id:"arrays-of-asynchronous-functions-that-return-objects"},"Arrays of asynchronous functions that return objects"),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = [\n  async (env) => ({\n    mode: 'development'\n  }),\n  async (env) => ({\n    mode: 'production'\n  })\n]\n")),(0,a.mdx)("h2",{id:"configuration"},"Configuration"),(0,a.mdx)("h3",{id:"overview-1"},"Overview"),(0,a.mdx)("p",null,"Assuming that ",(0,a.mdx)("inlineCode",{parentName:"p"},"config")," contains your Webpack configuration:"),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-javascript"},"{\n  mode: config.mode || 'production', \n  optimization: {\n    minimize: config.optimization.minimize || false\n  },\n  output: { \n    libraryTarget: config.output.libraryTarget || 'commonjs2',\n    path: './dist/${actionPath}/${actionName}-temp/' // Cannot change \n    fileName: `${output.path}/index.js` // Cannot change \n  },\n  target: 'node' // Cannot change\n  entry: [\n    '<path to the action>', \n    ...config.entry\n  ],\n  resolve: { \n    extensions: [\n      '.js', \n      '.json', \n      ...config.extensions\n    ],\n    mainFields: [ \n      'main',\n      ...config.mainFields\n    ]\n  },\n  plugins: [\n    new DefaultPlugin({\n      WEBPACK_ACTION_BUILD: 'true', \n      `process.env.AIO_CLI_ENV`: ${cliEnv}\n    }),\n    ...config.plugins\n  ]\n\n  // ... All other Webpack configuration options are valid\n\n}\n")),(0,a.mdx)("h3",{id:"base-options"},"Base options"),(0,a.mdx)("p",null,"App Builder starts off with these Webpack configuration options; any additional values will be added on for these fields:"),(0,a.mdx)("ul",null,(0,a.mdx)("li",{parentName:"ul"},(0,a.mdx)("inlineCode",{parentName:"li"},"entry")," always contains the path to the action; additional paths identified in your configuration file will be added on"),(0,a.mdx)("li",{parentName:"ul"},(0,a.mdx)("inlineCode",{parentName:"li"},"resolve.extensions")," always contains ",(0,a.mdx)("inlineCode",{parentName:"li"},".js")," and ",(0,a.mdx)("inlineCode",{parentName:"li"},".json"),"; additional extensions identified in your configuration file will be added on."),(0,a.mdx)("li",{parentName:"ul"},(0,a.mdx)("inlineCode",{parentName:"li"},"resolve.mainFields")," always contains ",(0,a.mdx)("inlineCode",{parentName:"li"},"main"),"; additional main fields identified in your configuration file will be added on.")),(0,a.mdx)("h3",{id:"defaults"},"Defaults"),(0,a.mdx)("p",null,"App Builder defaults to the following Webpack configuration options if they are not present in your configuration file:"),(0,a.mdx)("ul",null,(0,a.mdx)("li",{parentName:"ul"},(0,a.mdx)("inlineCode",{parentName:"li"},"output.libraryTarget")," defaults to ",(0,a.mdx)("inlineCode",{parentName:"li"},"commonjs2")),(0,a.mdx)("li",{parentName:"ul"},(0,a.mdx)("inlineCode",{parentName:"li"},"mode")," defaults to ",(0,a.mdx)("inlineCode",{parentName:"li"},"production")),(0,a.mdx)("li",{parentName:"ul"},(0,a.mdx)("inlineCode",{parentName:"li"},"optimization.minimize")," defaults to ",(0,a.mdx)("inlineCode",{parentName:"li"},"false"))),(0,a.mdx)("h3",{id:"immutable-options"},"Immutable options"),(0,a.mdx)("p",null,"App Builder does not allow changing of these Webpack configuration options; if these fields are present in your configuration file, they will be ignored:"),(0,a.mdx)("ul",null,(0,a.mdx)("li",{parentName:"ul"},(0,a.mdx)("inlineCode",{parentName:"li"},"target")," must be ",(0,a.mdx)("inlineCode",{parentName:"li"},"node"),"; I/O Runtime supports only Node.js as a runtime"),(0,a.mdx)("li",{parentName:"ul"},(0,a.mdx)("inlineCode",{parentName:"li"},"output.path"),"must be ",(0,a.mdx)("inlineCode",{parentName:"li"},"./dist/${actionPath}/${actionName}-temp/")),(0,a.mdx)("li",{parentName:"ul"},(0,a.mdx)("inlineCode",{parentName:"li"},"output.filename")," must be ",(0,a.mdx)("inlineCode",{parentName:"li"},"${output.path}/index.js"),(0,a.mdx)("ul",{parentName:"li"},(0,a.mdx)("li",{parentName:"ul"},"Note: If you are supplying multiple configurations, this will be true for the first configuration; subsequent configurations will be ",(0,a.mdx)("inlineCode",{parentName:"li"},"${output.path}/index.[hashname].js"))))),(0,a.mdx)("h2",{id:"environment-variables"},"Environment variables"),(0,a.mdx)("p",null,"If you export a function, an asynchronous function, or an array of functions from your Webpack configuration file, App Builder will pass the environment to those functions. You can use this to make decisions about bundling based on the environment."),(0,a.mdx)("p",null,"For example, if you export an environment variable called ",(0,a.mdx)("inlineCode",{parentName:"p"},"FEATURE_FLAG_PIRATES_BOUNTY")," before building your application, you can use it in your Webpack configuration file:"),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre",className:"language-javascript"},"module.exports = (env) => ({\n  mode: env.FEATURE_FLAG_PIRATES_BOUNTY ? 'production' : 'development'\n})\n")),(0,a.mdx)("h2",{id:"next-steps"},"Next steps"),(0,a.mdx)("p",null,"Return to ",(0,a.mdx)("a",{parentName:"p",href:"configuration.md"},"Configuration"),"."),(0,a.mdx)("p",null,"Return to ",(0,a.mdx)("a",{parentName:"p",href:"../../../guides/index.md"},"Guides Index"),"."))}s.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-app-builder-guides-configuration-webpack-configuration-md-7a37e84f8414ce1cb978.js.map