"use strict";(self.webpackChunkadobe_developer_app_builder=self.webpackChunkadobe_developer_app_builder||[]).push([[158],{71412:function(e,t,n){n.r(t),n.d(t,{_frontmatter:function(){return d},default:function(){return u}});var o=n(58168),a=n(80045),i=(n(88763),n(15680)),r=n(83407);const s=["components"],d={},l={_frontmatter:d},c=r.A;function u(e){let{components:t}=e,n=(0,a.A)(e,s);return(0,i.mdx)(c,(0,o.A)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,i.mdx)("h1",{id:"logging-and-monitoring"},"Logging and Monitoring"),(0,i.mdx)("p",null,"The ",(0,i.mdx)("inlineCode",{parentName:"p"},"AIO")," CLI offers a number of tools you can use to debug your actions while running them on Adobe I/O Runtime."),(0,i.mdx)("p",null,"You can retrieve the latest activations in a namespace by running:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},"aio rt:activation:list\n")),(0,i.mdx)("p",null,"Having an activation ID, you can retrieve the activation result running:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},"aio rt:activation:get <activation ID>\n")),(0,i.mdx)("p",null,"If you send data to logs from your actions (using ",(0,i.mdx)("inlineCode",{parentName:"p"},"console.log()")," in your code), you","’","ll get this information as part of the activation record, inside the ",(0,i.mdx)("inlineCode",{parentName:"p"},"logs")," field. The shortcut command to get the logs is:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},"aio rt:activation:logs <activation ID>\n//output sample\n2018-11-14T22:23:00.002Z       stdout: 1542234180001: param = John Doe\n")),(0,i.mdx)("h1",{id:"retrieving-activations-for-blocking-successful-calls"},"Retrieving activations for blocking successful calls"),(0,i.mdx)("p",null,"At scale, when you run millions of activations in a day, it may be difficult to extract the activations that failed in order to debug them. To help with this task, the system skips persisting the activation that succeeded. "),(0,i.mdx)("p",null,"The exceptions are asynchronous actions that are invoked in a non-blocking fashion. Their results are persisted regardless\nso that you can extract the response of the action at a later time. "),(0,i.mdx)("p",null,"However, during development it is important to have access to all activation results. You can enable this by setting in the request the extra logging header to ",(0,i.mdx)("inlineCode",{parentName:"p"},"on"),": "),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},"X-OW-EXTRA-LOGGING: on\n")),(0,i.mdx)("blockquote",null,(0,i.mdx)("p",{parentName:"blockquote"},"It's not recommended to use the extra logging headers in the production environment; it can reduce invocation performance. ")),(0,i.mdx)("h2",{id:"understanding-the-error-codes"},"Understanding the error codes"),(0,i.mdx)("p",null,"When you have action invocations that fail, sometimes the best way to understand the reason behind the failing is to take a look at the error object part of the activation record - running ",(0,i.mdx)("inlineCode",{parentName:"p"},"aio rt:activation:get <activationId>")," you will get the activation record."),(0,i.mdx)("p",null,"The following are the possible values and the meaning for ",(0,i.mdx)("inlineCode",{parentName:"p"},"error")," in ",(0,i.mdx)("inlineCode",{parentName:"p"},"response.status"),":"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"success"),": everything is okay (status is true)"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"action developer error"),": A container or action code error occurred, e.g. failed to start action (status is false). This is usually the case if the nodejs action code has a syntax error or missing dependencies"),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"application error"),": Action ran, but there was an error thrown in the action code (deliberatly or not) that was handled by I/O Runtime (status is false)."),(0,i.mdx)("li",{parentName:"ul"},(0,i.mdx)("inlineCode",{parentName:"li"},"whisk internal error"),": Action did not run, an internal I/O Runtime system error occurred while starting the action, more info in ",(0,i.mdx)("inlineCode",{parentName:"li"},"response.status.result.error"))),(0,i.mdx)("h2",{id:"third-party-tools"},"Third-Party tools"),(0,i.mdx)("p",null,"I/O Runtime doesn’t offer a configuration to send activations and logs to an external system, something like Splunk, Datadog or New Relic. This is something we are considering to offer in the future. "),(0,i.mdx)("p",null,"Although there is no out-of-the-box integration, there are still ways you can push data from I/O Runtime to an external tool in order to monitor and debug your actions. "),(0,i.mdx)("h4",{id:"epsagon"},"Epsagon"),(0,i.mdx)("p",null,"One tool that made it easy to do this is ",(0,i.mdx)("a",{parentName:"p",href:"https://epsagon.com"},"Epsagon"),". Epsagon built an integration for OpenWhisk-based systems like I/O Runtime that simplifies seeing your activations, errors, latency information and logs. Check this ",(0,i.mdx)("a",{parentName:"p",href:"https://docs.epsagon.com/docs/openwhisk?utm_source=adobe.io&utm_medium=referral&utm_campaign=adobe_io_docs"},"guide")," or this ",(0,i.mdx)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=4iprbivqrxQ&t=1517s"},"video presentation")," if you want to find more."),(0,i.mdx)("h4",{id:"new-relic"},"New Relic"),(0,i.mdx)("p",null,"Another tool that can be used to monitor your actions is New Relic, which offers a Node.js agent that can be used to monitor your actions. Check this ",(0,i.mdx)("a",{parentName:"p",href:"https://docs.newrelic.com/docs/agents/nodejs-agent/getting-started/introduction-new-relic-nodejs"},"guide")," to learn more."),(0,i.mdx)("p",null,"For example if you want to send to New Relic the execution time for one action, you could build your action code as follows:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},"const newrelic = require('newrelic');\n\nfunction main(params) {\n    const start = Date.now();\n\n    // your action code here\n\n    const end = Date.now();\n    const durationInMilliseconds = end - start;\n\n    // send duration to New Relic\n    newrelic.recordMetric('Custom/RunEndpointDuration', durationInMilliseconds);\n}\n")),(0,i.mdx)("p",null,"You need to package the new relic agent as part of your action code and deploy the action as ",(0,i.mdx)("a",{parentName:"p",href:"creating_actions.md#deploying-zip-actions"},".zip file"),". "),(0,i.mdx)("h2",{id:"debugging-locally"},"Debugging locally"),(0,i.mdx)("p",null,"Check this ",(0,i.mdx)("a",{parentName:"p",href:"debugging.md"},"page")," if you want to learn how to debug your actions locally."),(0,i.mdx)("h2",{id:"next-steps"},"Next steps"),(0,i.mdx)("p",null,"Return to the ",(0,i.mdx)("a",{parentName:"p",href:"../index.md"},"Guides Index"),"."))}u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-runtime-guides-logging-monitoring-md-857ab3e778ecb789ed51.js.map